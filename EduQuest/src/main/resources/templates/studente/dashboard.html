<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head th:replace="~{fragments/header :: head('EduQuest - Dashboard Studente')}"></head>
<body>
    <nav th:replace="~{fragments/navbar :: navbar}"></nav>
    
    <main class="container">
        <div class="dashboard">
            <header class="dashboard-header">
                <h1>Dashboard Studente</h1>
                <p>Benvenuto, <span th:text="${user.nome + ' ' + user.cognome}"></span>!</p>
            </header>
            
            <section th:replace="~{fragments/profile-card :: profileCard(${user}, false)}"></section>
            
            <section class="dashboard-section">
                <h3>ğŸ“Š Le Tue Statistiche</h3>
                <div class="stats-grid">
                    <div class="stat-card">
                        <span class="stat-value" th:text="${questionariCompletati != null ? questionariCompletati : 0}">0</span>
                        <span class="stat-label">Questionari Completati</span>
                    </div>
                    <div class="stat-card">
                        <span class="stat-value" th:text="${user.mediaPunteggio}">0.0</span>
                        <span class="stat-label">Media Voto</span>
                    </div>
                    <div class="stat-card">
                        <span class="stat-value" th:text="${user.eduPoints}">0</span>
                        <span class="stat-label">EduPoints</span>
                    </div>
                </div>
                <div>
                    <h3>
                        ğŸŒŸ Benvenuto in EduQuest! Potenzia il tuo profilo con gli EduPoints!
                        Gli EduPoints sono il cuore della tua scalata verso la vetta! Non sono semplici voti, ma punti bonus che premiano il tuo impegno, la tua costanza e la tua voglia di metterti in gioco.

                        Come puoi guadagnarli? ğŸš€

                        Dimostra quanto vali: Ogni volta che completi un quiz, ricevi punti in base al tuo risultato. PiÃ¹ alto Ã¨ il voto, piÃ¹ punti accumuli!

                        100% di risposte esatte: +15 EduPoints ğŸ†

                        Oltre il 75%: +10 EduPoints ğŸ¥ˆ

                        Oltre il 50%: +5 EduPoints ğŸ¥‰

                        Domina i Compitini: Alla scadenza di ogni Compitino, i primi 3 classificati (quelli con il voto piÃ¹ alto) riceveranno un super bonus extra! Controlla spesso la Dashboard per vedere se hai vinto.

                        Scala la classifica: Accumula EduPoints per scalare la Classifica globale e dimostrare a tutti chi Ã¨ il top player di EduQuest.

                        Pronto a scendere in campo? Buona fortuna e che vinca il migliore! ğŸ®ğŸ“–
                    </h3>
                </div>
            </section>
            
            <section class="dashboard-section">
                <h3>ğŸ“‹ Questionari Disponibili</h3>

                <form th:action="@{/studente/dashboard}" method="get" class="search-bar" style="margin-bottom: 1rem;">
                    <input type="text" name="cerca" th:value="${cerca}"
                           placeholder="Cerca per nome, descrizione o materia..." class="search-input" />
                    <button type="submit" class="btn btn-primary btn-sm">&#x1F50E; Cerca</button>
                    <a th:if="${cerca != null and !cerca.isEmpty()}" th:href="@{/studente/dashboard}"
                       class="btn btn-secondary btn-sm">&#x2716; Reset</a>
                </form>

                <p th:if="${cerca != null and !cerca.isEmpty()}" style="color: var(--text-secondary); font-size: 0.85rem; margin-bottom: 0.75rem;"
                   th:text="'Risultati per: &quot;' + ${cerca} + '&quot; (' + ${questionariDisponibili.size()} + ')'"></p>

                <div th:if="${questionariDisponibili == null or questionariDisponibili.empty}" class="empty-state">
                    <p th:if="${cerca != null and !cerca.isEmpty()}">Nessun questionario trovato per la tua ricerca.</p>
                    <p th:if="${cerca == null or cerca.isEmpty()}">Non ci sono questionari disponibili al momento.</p>
                </div>
                
                <div th:if="${questionariDisponibili != null and !questionariDisponibili.empty}" class="questionari-list">
                    <div th:each="q : ${questionariDisponibili}" class="questionario-card">
                        <h4 th:text="${q.nome}">Nome Questionario</h4>
                        <p th:text="${q.descrizione}">Descrizione</p>
                        <div class="card-meta">
                            <span>ğŸ“ <span th:text="${q.getNumeroDomande()}"></span> domande</span>
                            <span>ğŸ‘¨â€ğŸ« <span th:text="${q.docente.cognome}"></span></span>
                        </div>
                        <div class="card-actions">
                            <a th:href="@{/studente/dashboard/{id}(id=${q.ID})}" class="btn btn-primary btn-sm">Inizia</a>
                        </div>
                    </div>
                </div>
            </section>
        </div>
    </main>
    
    <footer th:replace="~{fragments/footer :: footer}"></footer>
</body>
</html>
